const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/PokemonDetailPage-BufYB_Mj.js","assets/index-CB5N3rpp.js","assets/index-CbIY0KcX.css","assets/App-DYKHi4eM.js","assets/App-3NgPJivT.css","assets/Footer-xKqXVpvq.js","assets/Footer-C8_IMnZK.css","assets/WithGlobalSearch-BJSSzPsa.js","assets/PokemonDetailPage-BBNKfEGU.css"])))=>i.map(i=>d[i]);
import{r as i,R as l,_ as F}from"./index-CB5N3rpp.js";import{L as M,u as B,f as _}from"./App-DYKHi4eM.js";const S={normal:"#e8e8b9",fire:"#e35b31",water:"#6890F0",electric:"#F8D030",grass:"#79bd5a",ice:"#98D8D8",fighting:"#dd463d",poison:"#e5f36f",ground:"#E0C068",flying:"#a1c5ea",psychic:"#cc82cc",bug:"#a1af1f",rock:"#857443",ghost:"#7c6698",dragon:"#9572ed",dark:"#686464",steel:"#B8B8D0",fairy:"#EE99AC"},I="#A8A878",O="linear-gradient(to right, #f5f5f5, #e0e0e0)",V=e=>{if(!e?.length)return O;if(e.length===1)return`linear-gradient(135deg, ${S[e[0].type.name]||I} 0%, white 100%)`;const t=S[e[0].type.name]||I,n=S[e[1].type.name]||I;return`linear-gradient(135deg, ${t} 0%, ${n} 100%)`},D=e=>S[e]||I,U={"generation-i":"#e8e8b9","generation-ii":"#e35b31","generation-iii":"#6890F0","generation-iv":"#e5f36f","generation-v":"#79bd5a","generation-vi":"#98D8D8","generation-vii":"#cc82cc","generation-viii":"#B8B8D0","generation-ix":"#EE99AC"},Fe=e=>U[e]||"#A8A878",x=e=>{if(e==null)return"#000";try{return`#${String(e).padStart(3,"0")}`}catch(t){return console.error("Error formatting Pokemon ID:",t),"#000"}},G=(e,t)=>{if(!e&&!t)return"Неизвестный покемон";if(t)return t;try{return e.charAt(0).toUpperCase()+e.slice(1).replace(/-/g," ")}catch(n){return console.error("Error formatting Pokemon name:",n),String(e)}},Me=e=>{if(e==null)return"Н/Д";try{return`${(Number(e)/10).toFixed(1)} м`}catch(t){return console.error("Error formatting Pokemon height:",t),"Н/Д"}},Be=e=>{if(e==null)return"Н/Д";try{return`${(Number(e)/10).toFixed(1)} кг`}catch(t){return console.error("Error formatting Pokemon weight:",t),"Н/Д"}},A="https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon",j=`${A}/other/official-artwork`,C=e=>{if(!e)return"";const t=Number(e);return isNaN(t)?"":t},W=e=>{const t=C(e);return t?`${j}/${t}.png`:""},J=(e,t)=>{if(!e)return"";const n=C(t);if(!n)return"";const o=e.other?.["official-artwork"]?.front_default,c=e.other?.["dream-world"]?.front_default,a=e.other?.home?.front_default,s=e.front_default;return o||c||a||s||W(n)},K=e=>{const t=C(e);return t?`${A}/${t}.png`:""},z=(e={})=>{const{onLoad:t,onError:n,fallbackSrc:o=""}=e,[c,a]=i.useState(!1),[s,r]=i.useState(!1),[u,d]=i.useState(!1),m=i.useCallback(g=>{a(!0),r(!1),t&&t(g)},[t]),f=i.useCallback(g=>{r(!0),o&&!u?(d(!0),g.target.src=o):a(!0),n&&n(g)},[n,o,u]),h=i.useCallback(()=>{a(!1),r(!1),d(!1)},[]);return{isLoaded:c,isError:s,useFallback:u,handleLoad:m,handleError:f,resetState:h}},H="Классический",Q="Огненный",q="Водный",X="Электрический",Y="Травяной",Z="Ледяной",ee="Боевой",te="Ядовитый",re="Земляной",ne="Летающий",oe="Психический",se="Насекомый",ae="Каменный",ce="Призрачный",ie="Дракон",le="Темный",ue="Стальной",de="Волшебный",me={normal:H,fire:Q,water:q,electric:X,grass:Y,ice:Z,fighting:ee,poison:te,ground:re,flying:ne,psychic:oe,bug:se,rock:ae,ghost:ce,dragon:ie,dark:le,steel:ue,fairy:de},fe="Здоровье",ge="Атака",he="Защита",ve="Скорость",pe={hp:fe,attack:ge,defense:he,"special-attack":"Спец. атака","special-defense":"Спец. защита",speed:ve},Ee={"generation-i":"Поколение I","generation-ii":"Поколение II","generation-iii":"Поколение III","generation-iv":"Поколение IV","generation-v":"Поколение V","generation-vi":"Поколение VI","generation-vii":"Поколение VII","generation-viii":"Поколение VIII","generation-ix":"Поколение IX"},ke=e=>me[e]||e,Oe=e=>pe[e]||e,Ve=e=>Ee[e]||e,N=new Map,ye=e=>e.replace(/POKéMON/gi,"покемон"),De=async(e,t="ru",n="en")=>{if(!e)return"";const o=`${n}:${t}:${e}`;if(N.has(o))return N.get(o);try{const c=`https://translate.googleapis.com/translate_a/single?client=gtx&sl=${n}&tl=${t}&dt=t&q=${encodeURIComponent(e)}`,a=await fetch(c);if(!a.ok)throw new Error(`HTTP error! status: ${a.status}`);const r=(await a.json())[0]?.map(d=>d[0]).join("")||"",u=ye(r);return N.set(o,u),u}catch(c){return console.error("Ошибка при переводе текста (Google Translate):",c),N.set(o,e),e}},be=i.memo(({type:e,onClick:t,isActive:n=!1,large:o=!1})=>{const c=D(e),a=ke(e),s=["type-badge",o?"large":"",n?"active":"",t?"clickable":""].filter(Boolean).join(" ");return l.createElement("div",{className:s,style:{backgroundColor:c},onClick:t?()=>t(e):void 0},a)}),L=i.memo(({pokemon:e,className:t="",asDiv:n=!1})=>{const{id:o,name:c,types:a,sprites:s}=e||{},r=i.useMemo(()=>J(s,o),[s,o]),u=i.useMemo(()=>K(o),[o]),d=i.useMemo(()=>V(a),[a]),m=i.useMemo(()=>G(c,e?.nameRu),[c,e?.nameRu]),f=i.useMemo(()=>x(o),[o]),{isLoaded:h,handleLoad:g,handleError:k}=z({fallbackSrc:u}),b=i.useMemo(()=>a?.map(v=>l.createElement(be,{key:`${o}-${v.type.name}`,type:v.type.name})),[a,o]),p=()=>{F(()=>import("./PokemonDetailPage-BufYB_Mj.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8]))};if(!e)return null;const y=l.createElement("div",{className:`pokemon-card ${h?"loaded":""} ${t}`,style:{background:d}},l.createElement("div",{className:"pokemon-card-content"},l.createElement("div",{className:"pokemon-card-header"},l.createElement("h2",{className:"pokemon-name"},m),l.createElement("span",{className:"pokemon-id"},f)),l.createElement("div",{className:"pokemon-image-container"},!h&&l.createElement("div",{className:"pokemon-image-skeleton","aria-hidden":"true"}),l.createElement("img",{src:r,alt:c,loading:"lazy",width:150,height:150,className:"pokemon-image",onLoad:g,onError:k})),l.createElement("div",{className:"pokemon-types"},b)));return n?y:l.createElement(M,{to:`/pokemon/${o}`,className:"pokemon-card-link","aria-label":`Покемон ${m}, ${f}`,onMouseEnter:p,onFocus:p,onTouchStart:p},y)});L.displayName="PokemonCard";const Ne=i.memo(()=>l.createElement("div",{className:"pokemon-card-skeleton"},l.createElement("div",{className:"pokemon-card-skeleton-content"},l.createElement("div",{className:"pokemon-card-skeleton-header"},l.createElement("div",{className:"pokemon-name-skeleton"}),l.createElement("div",{className:"pokemon-id-skeleton"})),l.createElement("div",{className:"pokemon-image-skeleton"}),l.createElement("div",{className:"pokemon-types-skeleton"},l.createElement("div",{className:"type-badge-skeleton"}),l.createElement("div",{className:"type-badge-skeleton"}))))),we=(e,t)=>{const n=()=>{if(typeof window>"u")return t;try{const s=window.localStorage.getItem(e);return s?JSON.parse(s):t}catch(s){return console.warn(`Ошибка при чтении из localStorage ключа "${e}":`,s),t}},[o,c]=i.useState(n),a=s=>{try{const r=s instanceof Function?s(o):s;c(r),typeof window<"u"&&window.localStorage.setItem(e,JSON.stringify(r))}catch(r){console.warn(`Ошибка при записи в localStorage ключа "${e}":`,r)}};return i.useEffect(()=>{const s=r=>{r.key===e&&c(r.newValue?JSON.parse(r.newValue):t)};if(typeof window<"u")return window.addEventListener("storage",s),()=>{window.removeEventListener("storage",s)}},[t,e]),[o,a]},Se=()=>{const[e,t]=we("pokemon-favorites",[]),n=i.useMemo(()=>new Set(e),[e]);i.useEffect(()=>{window.dispatchEvent(new CustomEvent("favorites-updated"))},[e]);const o=i.useCallback(r=>n.has(r),[n]),c=i.useCallback(r=>{n.has(r)||t([...e,r])},[e,n,t]),a=i.useCallback(r=>{n.has(r)&&t(e.filter(u=>u!==r))},[e,n,t]),s=i.useCallback(r=>{n.has(r)?t(e.filter(u=>u!==r)):t([...e,r])},[e,n,t]);return i.useMemo(()=>({favorites:e,isFavorite:o,addToFavorites:c,removeFromFavorites:a,toggleFavorite:s,favoritesCount:e.length}),[e,o,c,a,s])};function Ie(e){const t=i.useRef();return i.useEffect(()=>{t.current=e},[e]),t.current}var R=new Map,w=new WeakMap,T=0,$e=void 0;function Re(e){return e?(w.has(e)||(T+=1,w.set(e,T.toString())),w.get(e)):"0"}function Ce(e){return Object.keys(e).sort().filter(t=>e[t]!==void 0).map(t=>`${t}_${t==="root"?Re(e.root):e[t]}`).toString()}function Pe(e){const t=Ce(e);let n=R.get(t);if(!n){const o=new Map;let c;const a=new IntersectionObserver(s=>{s.forEach(r=>{var u;const d=r.isIntersecting&&c.some(m=>r.intersectionRatio>=m);e.trackVisibility&&typeof r.isVisible>"u"&&(r.isVisible=d),(u=o.get(r.target))==null||u.forEach(m=>{m(d,r)})})},e);c=a.thresholds||(Array.isArray(e.threshold)?e.threshold:[e.threshold||0]),n={id:t,observer:a,elements:o},R.set(t,n)}return n}function _e(e,t,n={},o=$e){if(typeof window.IntersectionObserver>"u"&&o!==void 0){const u=e.getBoundingClientRect();return t(o,{isIntersecting:o,target:e,intersectionRatio:typeof n.threshold=="number"?n.threshold:0,time:0,boundingClientRect:u,intersectionRect:u,rootBounds:u}),()=>{}}const{id:c,observer:a,elements:s}=Pe(n),r=s.get(e)||[];return s.has(e)||s.set(e,r),r.push(t),a.observe(e),function(){r.splice(r.indexOf(t),1),r.length===0&&(s.delete(e),a.unobserve(e)),s.size===0&&(a.disconnect(),R.delete(c))}}function Te({threshold:e,delay:t,trackVisibility:n,rootMargin:o,root:c,triggerOnce:a,skip:s,initialInView:r,fallbackInView:u,onChange:d}={}){var m;const[f,h]=i.useState(null),g=i.useRef(d),[k,b]=i.useState({inView:!!r,entry:void 0});g.current=d,i.useEffect(()=>{if(s||!f)return;let E;return E=_e(f,(P,$)=>{b({inView:P,entry:$}),g.current&&g.current(P,$),$.isIntersecting&&a&&E&&(E(),E=void 0)},{root:c,rootMargin:o,threshold:e,trackVisibility:n,delay:t},u),()=>{E&&E()}},[Array.isArray(e)?e.toString():e,f,c,o,a,s,n,u,t]);const p=(m=k.entry)==null?void 0:m.target,y=i.useRef(void 0);!f&&p&&!a&&!s&&y.current!==p&&(y.current=p,b({inView:!!r,entry:void 0}));const v=[h,k.inView,k.entry];return v.ref=v[0],v.inView=v[1],v.entry=v[2],v}const Ue=()=>{const{pokemons:e,loading:t,error:n,hasMore:o,fetchPokemons:c,searchQuery:a,selectedType:s,selectedGeneration:r}=B(),{favorites:u}=Se(),d=Ie(a),{ref:m,inView:f}=Te({threshold:.1,triggerOnce:!1});return i.useEffect(()=>{e.length===0&&!a&&!s&&!r&&!t&&c()},[e.length,a,s,r,t,c]),i.useEffect(()=>{d&&!a&&e.length===0&&!t&&c()},[a,e.length,t,d,c]),i.useEffect(()=>{f&&o&&!t&&!a&&!s&&!r&&c()},[f,o,t,a,s,r,c]),n&&e.length===0?l.createElement(_,{error:typeof n=="string"?new Error(n):n}):!t&&e.length===0&&(s||r)?l.createElement(_,{message:"Покемоны не найдены. Попробуйте изменить фильтры."}):l.createElement("div",{className:"pokemon-list-container"},l.createElement("div",{className:"pokemon-grid"},e.map(h=>l.createElement(L,{key:h.id,pokemon:h,className:"pokemon-list-card"})),t&&Array(6).fill(0).map((h,g)=>l.createElement(Ne,{key:`skeleton-${g}`})),o&&!a&&!s&&!r&&l.createElement("div",{ref:m,className:"scroll-trigger"}),e.length===0&&!t&&a&&l.createElement("div",{className:"empty-search-result"},l.createElement("h3",null,"Покемоны не найдены"),l.createElement("p",null,"Попробуйте изменить поисковый запрос"))))};export{Ue as P,be as T,Ve as a,ke as b,Ne as c,L as d,J as e,x as f,Fe as g,G as h,Me as i,Be as j,D as k,Oe as l,V as m,K as n,De as t,Se as u};
