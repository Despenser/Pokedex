import{r as a}from"./index-Du0vXYoH.js";const u=(e,r)=>{const s=()=>{if(typeof window>"u")return r;try{const o=window.localStorage.getItem(e);return o?JSON.parse(o):r}catch(o){return console.warn(`Ошибка при чтении из localStorage ключа "${e}":`,o),r}},[n,c]=a.useState(s),i=o=>{try{const t=o instanceof Function?o(n):o;c(t),typeof window<"u"&&window.localStorage.setItem(e,JSON.stringify(t))}catch(t){console.warn(`Ошибка при записи в localStorage ключа "${e}":`,t)}};return a.useEffect(()=>{const o=t=>{t.key===e&&c(t.newValue?JSON.parse(t.newValue):r)};if(typeof window<"u")return window.addEventListener("storage",o),()=>{window.removeEventListener("storage",o)}},[r,e]),[n,i]},w=()=>{const[e,r]=u("pokemon-favorites",[]),s=a.useMemo(()=>new Set(e),[e]);a.useEffect(()=>{window.dispatchEvent(new CustomEvent("favorites-updated"))},[e]);const n=a.useCallback(t=>s.has(t),[s]),c=a.useCallback(t=>{s.has(t)||r([...e,t])},[e,s,r]),i=a.useCallback(t=>{s.has(t)&&r(e.filter(f=>f!==t))},[e,s,r]),o=a.useCallback(t=>{s.has(t)?r(e.filter(f=>f!==t)):r([...e,t])},[e,s,r]);return a.useMemo(()=>({favorites:e,isFavorite:n,addToFavorites:c,removeFromFavorites:i,toggleFavorite:o,favoritesCount:e.length}),[e,n,c,i,o])};export{w as u};
