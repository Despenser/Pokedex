const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/PokemonDetailPage-BMUz9HVr.js","assets/index-Df_6KZdj.js","assets/index-CqL0Psyp.css","assets/App-CF2eCG8w.js","assets/App-2EUHJS9_.css","assets/Footer-CdXV03ZN.js","assets/Footer-C8_IMnZK.css","assets/WithGlobalSearch-CIfBekL4.js","assets/PokemonDetailPage-BbK7Ib1y.css"])))=>i.map(i=>d[i]);
import{r as i,R as c,_ as A}from"./index-Df_6KZdj.js";import{L as F,u as _,f as L}from"./App-CF2eCG8w.js";const S={normal:"#e8e8b9",fire:"#e35b31",water:"#6890F0",electric:"#F8D030",grass:"#79bd5a",ice:"#98D8D8",fighting:"#dd463d",poison:"#e5f36f",ground:"#E0C068",flying:"#a1c5ea",psychic:"#cc82cc",bug:"#a1af1f",rock:"#857443",ghost:"#7c6698",dragon:"#9572ed",dark:"#686464",steel:"#B8B8D0",fairy:"#EE99AC"},I="#A8A878",M="linear-gradient(to right, #f5f5f5, #e0e0e0)",O=e=>{if(!e?.length)return M;if(e.length===1)return`linear-gradient(135deg, ${S[e[0].type.name]||I} 0%, white 100%)`;const t=S[e[0].type.name]||I,n=S[e[1].type.name]||I;return`linear-gradient(135deg, ${t} 0%, ${n} 100%)`},B=e=>S[e]||I,V={"generation-i":"#e8e8b9","generation-ii":"#e35b31","generation-iii":"#6890F0","generation-iv":"#e5f36f","generation-v":"#79bd5a","generation-vi":"#98D8D8","generation-vii":"#cc82cc","generation-viii":"#B8B8D0","generation-ix":"#EE99AC"},Ae=e=>V[e]||"#A8A878",D=e=>{if(e==null)return"#000";try{return`#${String(e).padStart(3,"0")}`}catch(t){return console.error("Error formatting Pokemon ID:",t),"#000"}},z=(e,t)=>{if(!e&&!t)return"Неизвестный покемон";if(t)return t;try{return e.charAt(0).toUpperCase()+e.slice(1).replace(/-/g," ")}catch(n){return console.error("Error formatting Pokemon name:",n),String(e)}},Fe=e=>{if(e==null)return"Н/Д";try{return`${(Number(e)/10).toFixed(1)} м`}catch(t){return console.error("Error formatting Pokemon height:",t),"Н/Д"}},_e=e=>{if(e==null)return"Н/Д";try{return`${(Number(e)/10).toFixed(1)} кг`}catch(t){return console.error("Error formatting Pokemon weight:",t),"Н/Д"}},W="/official-artwork",x=e=>{if(!e)return"";const t=Number(e);return isNaN(t)?"":t},G=e=>{const t=x(e);return t?`${W}/${t}.webp`:""},U=e=>({src:G(e)}),j=(e={})=>{const{onLoad:t,onError:n,fallbackSrc:s=""}=e,[l,o]=i.useState(!1),[a,r]=i.useState(!1),[u,d]=i.useState(!1),f=i.useCallback(g=>{o(!0),r(!1),t&&t(g)},[t]),v=i.useCallback(g=>{r(!0),s&&!u?(d(!0),g.target.src=s):o(!0),n&&n(g)},[n,s,u]),p=i.useCallback(()=>{o(!1),r(!1),d(!1)},[]);return{isLoaded:l,isError:a,useFallback:u,handleLoad:f,handleError:v,resetState:p}},J="Классический",K="Огненный",H="Водный",Q="Электрический",q="Травяной",X="Ледяной",Y="Боевой",Z="Ядовитый",ee="Земляной",te="Летающий",re="Психический",ne="Насекомый",oe="Каменный",se="Призрачный",ae="Дракон",ce="Темный",ie="Стальной",le="Волшебный",ue={normal:J,fire:K,water:H,electric:Q,grass:q,ice:X,fighting:Y,poison:Z,ground:ee,flying:te,psychic:re,bug:ne,rock:oe,ghost:se,dragon:ae,dark:ce,steel:ie,fairy:le},de="Здоровье",me="Атака",fe="Защита",ge="Скорость",ve={hp:de,attack:me,defense:fe,"special-attack":"Спец. атака","special-defense":"Спец. защита",speed:ge},he={"generation-i":"Поколение I","generation-ii":"Поколение II","generation-iii":"Поколение III","generation-iv":"Поколение IV","generation-v":"Поколение V","generation-vi":"Поколение VI","generation-vii":"Поколение VII","generation-viii":"Поколение VIII","generation-ix":"Поколение IX"},pe=e=>ue[e]||e,Me=e=>ve[e]||e,Oe=e=>he[e]||e,b=new Map,Ee=e=>e.replace(/POKéMON/gi,"покемон"),Be=async(e,t="ru",n="en")=>{if(!e)return"";const s=`${n}:${t}:${e}`;if(b.has(s))return b.get(s);try{const l=`https://translate.googleapis.com/translate_a/single?client=gtx&sl=${n}&tl=${t}&dt=t&q=${encodeURIComponent(e)}`,o=await fetch(l);if(!o.ok)throw new Error(`HTTP error! status: ${o.status}`);const r=(await o.json())[0]?.map(d=>d[0]).join("")||"",u=Ee(r);return b.set(s,u),u}catch(l){return console.error("Ошибка при переводе текста (Google Translate):",l),b.set(s,e),e}},ke=i.memo(({type:e,onClick:t,isActive:n=!1,large:s=!1})=>{const l=B(e),o=pe(e),a=["type-badge",s?"large":"",n?"active":"",t?"clickable":""].filter(Boolean).join(" ");return c.createElement("div",{className:a,style:{backgroundColor:l},onClick:t?()=>t(e):void 0},o)}),T=i.memo(({pokemon:e,className:t="",asDiv:n=!1})=>{const{id:s,name:l,types:o,sprites:a}=e||{},{src:r}=i.useMemo(()=>U(s),[s]),u=i.useMemo(()=>O(o),[o]),d=i.useMemo(()=>z(l,e?.nameRu),[l,e?.nameRu]),f=i.useMemo(()=>D(s),[s]),{isLoaded:v,handleLoad:p}=j(),g=()=>window.innerWidth<=400?90:window.innerWidth<=600?100:window.innerWidth<=899?120:150,[E,y]=c.useState(g());c.useEffect(()=>{const m=()=>y(g());return window.addEventListener("resize",m),()=>window.removeEventListener("resize",m)},[]);const w=i.useMemo(()=>o?.map(m=>c.createElement(ke,{key:`${s}-${m.type.name}`,type:m.type.name})),[o,s]),k=()=>{A(()=>import("./PokemonDetailPage-BMUz9HVr.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8]))};if(!e)return null;const h=c.createElement("div",{className:`pokemon-card ${v?"loaded":""} ${t}`,style:{background:u}},c.createElement("div",{className:"pokemon-card-content"},c.createElement("div",{className:"pokemon-card-header"},c.createElement("h2",{className:"pokemon-name"},d),c.createElement("span",{className:"pokemon-id"},f)),c.createElement("div",{className:"pokemon-image-container"},!v&&c.createElement("div",{className:"pokemon-image-skeleton","aria-hidden":"true"}),c.createElement("img",{src:r,alt:l,loading:"lazy",width:E,height:E,className:"pokemon-image",onLoad:p,onError:m=>{m.target.src="/official-artwork/unknown.webp"}})),c.createElement("div",{className:"pokemon-types"},w)));return n?h:c.createElement(F,{to:`/pokemon/${s}`,className:"pokemon-card-link","aria-label":`Покемон ${d}, ${f}`,onMouseEnter:k,onFocus:k,onTouchStart:k},h)});T.displayName="PokemonCard";const we=i.memo(()=>c.createElement("div",{className:"pokemon-card-skeleton"},c.createElement("div",{className:"pokemon-card-skeleton-content"},c.createElement("div",{className:"pokemon-card-skeleton-header"},c.createElement("div",{className:"pokemon-name-skeleton"}),c.createElement("div",{className:"pokemon-id-skeleton"})),c.createElement("div",{className:"pokemon-image-skeleton"}),c.createElement("div",{className:"pokemon-types-skeleton"},c.createElement("div",{className:"type-badge-skeleton"}),c.createElement("div",{className:"type-badge-skeleton"}))))),ye=(e,t)=>{const n=()=>{if(typeof window>"u")return t;try{const a=window.localStorage.getItem(e);return a?JSON.parse(a):t}catch(a){return console.warn(`Ошибка при чтении из localStorage ключа "${e}":`,a),t}},[s,l]=i.useState(n),o=a=>{try{const r=a instanceof Function?a(s):a;l(r),typeof window<"u"&&window.localStorage.setItem(e,JSON.stringify(r))}catch(r){console.warn(`Ошибка при записи в localStorage ключа "${e}":`,r)}};return i.useEffect(()=>{const a=r=>{r.key===e&&l(r.newValue?JSON.parse(r.newValue):t)};if(typeof window<"u")return window.addEventListener("storage",a),()=>{window.removeEventListener("storage",a)}},[t,e]),[s,o]},be=()=>{const[e,t]=ye("pokemon-favorites",[]),n=i.useMemo(()=>new Set(e),[e]);i.useEffect(()=>{window.dispatchEvent(new CustomEvent("favorites-updated"))},[e]);const s=i.useCallback(r=>n.has(r),[n]),l=i.useCallback(r=>{n.has(r)||t([...e,r])},[e,n,t]),o=i.useCallback(r=>{n.has(r)&&t(e.filter(u=>u!==r))},[e,n,t]),a=i.useCallback(r=>{n.has(r)?t(e.filter(u=>u!==r)):t([...e,r])},[e,n,t]);return i.useMemo(()=>({favorites:e,isFavorite:s,addToFavorites:l,removeFromFavorites:o,toggleFavorite:a,favoritesCount:e.length}),[e,s,l,o,a])};function Ne(e){const t=i.useRef();return i.useEffect(()=>{t.current=e},[e]),t.current}var $=new Map,N=new WeakMap,P=0,Se=void 0;function Ie(e){return e?(N.has(e)||(P+=1,N.set(e,P.toString())),N.get(e)):"0"}function Ce(e){return Object.keys(e).sort().filter(t=>e[t]!==void 0).map(t=>`${t}_${t==="root"?Ie(e.root):e[t]}`).toString()}function $e(e){const t=Ce(e);let n=$.get(t);if(!n){const s=new Map;let l;const o=new IntersectionObserver(a=>{a.forEach(r=>{var u;const d=r.isIntersecting&&l.some(f=>r.intersectionRatio>=f);e.trackVisibility&&typeof r.isVisible>"u"&&(r.isVisible=d),(u=s.get(r.target))==null||u.forEach(f=>{f(d,r)})})},e);l=o.thresholds||(Array.isArray(e.threshold)?e.threshold:[e.threshold||0]),n={id:t,observer:o,elements:s},$.set(t,n)}return n}function Re(e,t,n={},s=Se){if(typeof window.IntersectionObserver>"u"&&s!==void 0){const u=e.getBoundingClientRect();return t(s,{isIntersecting:s,target:e,intersectionRatio:typeof n.threshold=="number"?n.threshold:0,time:0,boundingClientRect:u,intersectionRect:u,rootBounds:u}),()=>{}}const{id:l,observer:o,elements:a}=$e(n),r=a.get(e)||[];return a.has(e)||a.set(e,r),r.push(t),o.observe(e),function(){r.splice(r.indexOf(t),1),r.length===0&&(a.delete(e),o.unobserve(e)),a.size===0&&(o.disconnect(),$.delete(l))}}function Le({threshold:e,delay:t,trackVisibility:n,rootMargin:s,root:l,triggerOnce:o,skip:a,initialInView:r,fallbackInView:u,onChange:d}={}){var f;const[v,p]=i.useState(null),g=i.useRef(d),[E,y]=i.useState({inView:!!r,entry:void 0});g.current=d,i.useEffect(()=>{if(a||!v)return;let m;return m=Re(v,(R,C)=>{y({inView:R,entry:C}),g.current&&g.current(R,C),C.isIntersecting&&o&&m&&(m(),m=void 0)},{root:l,rootMargin:s,threshold:e,trackVisibility:n,delay:t},u),()=>{m&&m()}},[Array.isArray(e)?e.toString():e,v,l,s,o,a,n,u,t]);const w=(f=E.entry)==null?void 0:f.target,k=i.useRef(void 0);!v&&w&&!o&&!a&&k.current!==w&&(k.current=w,y({inView:!!r,entry:void 0}));const h=[p,E.inView,E.entry];return h.ref=h[0],h.inView=h[1],h.entry=h[2],h}const Ve=()=>{const{pokemons:e,loading:t,error:n,hasMore:s,fetchPokemons:l,searchQuery:o,selectedType:a,selectedGeneration:r}=_(),{favorites:u}=be(),d=Ne(o),{ref:f,inView:v}=Le({threshold:.1,triggerOnce:!1});return i.useEffect(()=>{e.length===0&&!o&&!a&&!r&&!t&&l()},[e.length,o,a,r,t,l]),i.useEffect(()=>{d&&!o&&e.length===0&&!t&&l()},[o,e.length,t,d,l]),i.useEffect(()=>{v&&s&&!t&&!o&&!a&&!r&&l()},[v,s,t,o,a,r,l]),n&&e.length===0?c.createElement(L,{error:typeof n=="string"?new Error(n):n}):!t&&e.length===0&&(a||r)?c.createElement(L,{message:"Покемоны не найдены. Попробуйте изменить фильтры."}):c.createElement("div",{className:"pokemon-list-container"},c.createElement("div",{className:"pokemon-grid"},e.map(p=>c.createElement(T,{key:p.id,pokemon:p,className:"pokemon-list-card"})),t&&Array(6).fill(0).map((p,g)=>c.createElement(we,{key:`skeleton-${g}`})),s&&!o&&!a&&!r&&c.createElement("div",{ref:f,className:"scroll-trigger"}),e.length===0&&!t&&o&&c.createElement("div",{className:"empty-search-result"},c.createElement("h3",null,"Покемоны не найдены"),c.createElement("p",null,"Попробуйте изменить поисковый запрос"))))};export{Ve as P,ke as T,Oe as a,pe as b,we as c,T as d,U as e,D as f,Ae as g,z as h,Fe as i,_e as j,B as k,Me as l,O as m,Be as t,be as u};
