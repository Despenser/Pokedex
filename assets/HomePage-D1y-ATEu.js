import{r as c,R as e,L as g}from"./index-CB5N3rpp.js";import{F as p}from"./Footer-xKqXVpvq.js";import{u as o}from"./App-DYKHi4eM.js";import{T as f,g as h,a as k,P as b,b as u}from"./PokemonList-DSboICHW.js";const d=a=>{const t=o(),l=c.useCallback(s=>{const n=Date.now(),m=(a==="type"?t.selectedType:t.selectedGeneration)===s?null:s;o.setState({loading:!0,pokemons:[],error:null,lastRequestId:n}),setTimeout(()=>{o.getState().lastRequestId===n&&(a==="type"?t.setSelectedType(m):t.setSelectedGeneration(m))},50)},[a,t]),r=c.useCallback(()=>{const s=Date.now();o.setState({loading:!0,pokemons:[],error:null,lastRequestId:s}),setTimeout(()=>{o.getState().lastRequestId===s&&(a==="type"?t.setSelectedType(null):t.setSelectedGeneration(null))},50)},[a,t]);return{handleFilterClick:l,handleFilterReset:r}},N=c.memo(()=>{const{pokemonTypes:a,selectedType:t,fetchPokemonTypes:l}=o(),{handleFilterClick:r,handleFilterReset:s}=d("type");return c.useEffect(()=>{l()},[l]),e.createElement("div",{className:"types-filter"},e.createElement("div",{className:"types-filter-header"},e.createElement("h3",null,"Фильтр по типам"),t&&e.createElement("button",{className:"back-button",onClick:s},"Сбросить тип")),e.createElement("div",{className:"types-badges"},a.map(n=>e.createElement(f,{key:n.name,type:n.name,onClick:r,isActive:t===n.name}))))}),y=({generation:a,onClick:t,isActive:l=!1})=>{const r=k(a),s=h(a),n=["generation-badge",l&&"active",t&&"clickable"].filter(Boolean).join(" "),i=t?()=>t(a):void 0;return e.createElement("div",{className:n,onClick:i,"aria-label":`Поколение ${r}`,style:{backgroundColor:s,color:"rgba(0,0,0,0.65)"}},e.createElement("span",{className:"generation-badge-name"},r))},C=c.memo(()=>{const{generations:a,selectedGeneration:t,fetchGenerations:l}=o(),{handleFilterClick:r,handleFilterReset:s}=d("generation");return c.useEffect(()=>{l()},[l,a.length]),e.createElement("div",{className:"generations-filter"},e.createElement("div",{className:"generations-filter-header"},e.createElement("h3",null,"Фильтр по поколениям"),t&&e.createElement("button",{className:"back-button",onClick:s},"Сбросить поколение")),e.createElement("div",{className:"generations-badges"},a.map(n=>e.createElement(y,{key:n.name,generation:n.name,onClick:r,isActive:t===n.name}))))}),F=c.memo(({selectedType:a,selectedGeneration:t,onResetFilters:l})=>e.createElement("div",{className:"filters-container"},e.createElement(N,null),e.createElement(C,null),(a||t)&&e.createElement("button",{className:"reset-all-filters back-button",onClick:l},"Сбросить все фильтры"))),v=({loading:a,offset:t,pokemons:l})=>{const r=c.useMemo(()=>a&&t===0&&l.length===0,[a,t,l.length]);return e.createElement(e.Fragment,null,a&&e.createElement("div",{className:"filter-updating"},"Обновление данных..."),r?e.createElement(g,null):e.createElement(b,null))},P=()=>{const{loading:a,offset:t,pokemons:l,searchQuery:r,selectedType:s,selectedGeneration:n,resetSearch:i}=o(),m=c.useCallback(()=>{i()},[i]),E=c.useMemo(()=>r?"Результаты поиска":s&&n?`Покемоны типа ${u(s)} из поколения ${n.replace("generation-","").toUpperCase()}`:s?`Покемоны типа ${u(s)}`:n?`Покемоны поколения ${n.replace("generation-","").toUpperCase()}`:"Все покемоны",[r,s,n]);return c.useEffect(()=>{window.scrollTo(0,0)},[]),c.useEffect(()=>{l.length===0&&!s&&!n&&!r&&!a&&(async()=>await o.getState().fetchPokemons())()},[l.length,s,n,r,a]),e.createElement("div",{className:"home-page"},e.createElement("main",{className:"main-content"},e.createElement("div",{className:"container"},e.createElement(F,{selectedType:s,selectedGeneration:n,onResetFilters:m}),e.createElement("h2",{className:"section-title"},E),e.createElement(v,{loading:a,offset:t,pokemons:l}))),e.createElement(p,null))};export{P as default};
