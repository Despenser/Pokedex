import{j as e,r as m}from"./index-Du0vXYoH.js";import{F as x}from"./Footer-DlYLaU0K.js";import{P as j,b as g}from"./PokemonCardSkeleton-HXPW-wch.js";import{E as h,s as P,p as k,g as E}from"./App-CBnKlSPQ.js";import{u as N}from"./useFavorites-Vdnob2mK.js";const y=()=>e.jsxs("div",{className:"empty-favorites",children:[e.jsxs("picture",{children:[e.jsx("source",{srcSet:"/favorites.webp",type:"image/webp"}),e.jsx("img",{src:"/favorites.svg",alt:"Нет избранных покемонов",className:"empty-favorites-img",loading:"lazy"})]}),e.jsx("h2",{children:"У вас пока нет избранных покемонов"}),e.jsx("p",{children:"Добавляйте покемонов в избранное, нажимая на значок сердечка на странице покемона"})]}),F=({favoritePokemons:s,isLoading:t,error:r,favoriteIds:a})=>r?e.jsx("div",{className:"favorites-error-container",children:e.jsx(h,{error:typeof r=="string"?new Error(r):r})}):!t&&a.length===0?e.jsx(y,{}):e.jsxs("div",{className:"pokemon-grid",children:[s.map(o=>e.jsx(j,{pokemon:o},o.id)),t&&a.map((o,l)=>e.jsx(g,{},`skeleton-${o}-${l}`))]}),S=()=>{const{favorites:s}=N(),[t,r]=m.useState([]),[a,o]=m.useState(!0),[l,d]=m.useState(null);return m.useEffect(()=>{(async()=>{if(s.length===0){o(!1);return}o(!0),d(null);const u=s.map(n=>P(()=>E(n),{errorContext:`загрузка покемона #${n}`,errorType:"POKEMON_LOAD"})),v=await Promise.all(u),c=[];let f=!1;v.forEach(([n,i],p)=>{n?(console.error(`Ошибка при загрузке покемона #${s[p]}:`,n),f=!0):i&&c.push({...i,nameRu:k[i.name]||void 0})}),f&&c.length<s.length&&d({message:"Не удалось загрузить некоторых покемонов. Пожалуйста, попробуйте позже."}),c.sort((n,i)=>n.id-i.id),r(c),o(!1)})()},[s]),m.useMemo(()=>({favoritePokemons:t,isLoading:a,error:l,favoriteIds:s}),[t,a,l,s])},L=()=>{const{favoritePokemons:s,isLoading:t,error:r,favoriteIds:a}=S();return e.jsxs("div",{className:"favorites-page",children:[e.jsx("main",{className:"main-content",children:e.jsxs("div",{className:"container",children:[e.jsx("h1",{className:"favorites-title",children:"Избранные покемоны"}),e.jsx(F,{favoritePokemons:s,isLoading:t,error:r,favoriteIds:a})]})}),e.jsx(x,{})]})};export{L as default};
